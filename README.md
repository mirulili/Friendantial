# Friendantial API

**ì¹œêµ¬ì²˜ëŸ¼ ì¹œê·¼í•œ AI íˆ¬ì ì–´ë“œë°”ì´ì €, Friendantial**

Friendantial APIëŠ” ë°ì´ íŠ¸ë ˆì´ë”ê°€ ì•„ì¹¨ì— ì‹œì¥ì„ ì¤€ë¹„í•  ë•Œ ì°¸ê³ í•  ìˆ˜ ìˆëŠ” ì£¼ì‹ ì¶”ì²œ ë° ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•˜ëŠ” API ì„œë²„ì…ë‹ˆë‹¤. ë³µì¡í•œ ê¸ˆìœµ ë°ì´í„°ë¥¼ AIì™€ LLMì„ í†µí•´ ë¶„ì„í•˜ì—¬, ì´í•´í•˜ê¸° ì‰¬ìš´ ìì—°ì–´ ë¦¬í¬íŠ¸ì™€ ì •ëŸ‰ì ì¸ ì¶”ì²œ ì ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

*   **ì¢…í•© ì ìˆ˜ ê¸°ë°˜ ì£¼ì‹ ì¶”ì²œ**:
    *   **ë‹¤ì¤‘ íŒ©í„° ë¶„ì„**: ëª¨ë©˜í…€(ë‹¨ê¸°/ì¤‘ê¸°/ì¥ê¸°), ë‰´ìŠ¤ ê°ì„±, ë³€ë™ì„±, ê±°ë˜ëŒ€ê¸ˆ ë“± ì—¬ëŸ¬ ì§€í‘œë¥¼ ì¢…í•©í•˜ì—¬ ì¶”ì²œ ì ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    *   **100ì  ë§Œì  ìŠ¤ì¼€ì¼**: ìµœì¢… ì¶”ì²œ ì ìˆ˜ë¥¼ 0ì ì—ì„œ 100ì  ì‚¬ì´ì˜ ì§ê´€ì ì¸ ì •ìˆ˜ ê°’ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.

*   **ë™ì  ì‹œì¥ ìƒí™© ë¶„ì„ (Market Regime)**:
    *   ì‹œì¥ ëŒ€í‘œ ì§€ìˆ˜(KODEX 200 ë“±)ì˜ ì´ë™í‰ê· ì„ ì„ ë¶„ì„í•˜ì—¬ í˜„ì¬ ì‹œì¥ì„ ìƒìŠ¹ì¥(BULL), í•˜ë½ì¥(BEAR), ì¤‘ë¦½ì¥(NEUTRAL)ìœ¼ë¡œ ìë™ íŒë‹¨í•˜ê³ , ì´ì— ë”°ë¼ ì ìˆ˜ ê³„ì‚° ê°€ì¤‘ì¹˜ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì •í•©ë‹ˆë‹¤.

*   **íŠ¸ë ˆì´ë”© ì „ëµë³„ ë§ì¶¤ ì¶”ì²œ**:
    *   API í˜¸ì¶œ ì‹œ `strategy` íŒŒë¼ë¯¸í„°(`day_trader`, `long_term`)ë¥¼ í†µí•´ ì‚¬ìš©ìì˜ íˆ¬ì ìŠ¤íƒ€ì¼ì— ë§ëŠ” ê°ê¸° ë‹¤ë¥¸ ë¡œì§ìœ¼ë¡œ ì¢…ëª©ì„ ì¶”ì²œë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    *   **ë°ì´ íŠ¸ë ˆì´ë” ì „ëµ**: 5ì¼/20ì¼ ì´ë™í‰ê· ì„ , ì „ì¼ ë“±ë½ë¥ , ê±°ë˜ëŸ‰ ê¸‰ë“±ê³¼ ê°™ì€ ë‹¨ê¸° ì§€í‘œì— ë” ë†’ì€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.

*   **LLMì„ í™œìš©í•œ ìì—°ì–´ ë¦¬í¬íŠ¸ ìƒì„±**:
    *   **ì¢…í•© ë¦¬í¬íŠ¸ (`/reporting/summary`)**: ì¶”ì²œëœ ìƒìœ„ ì¢…ëª©ë“¤ì˜ í•µì‹¬ ë°ì´í„°ë¥¼ ìš”ì•½í•˜ì—¬, ì¹œêµ¬ì—ê²Œ ì„¤ëª…í•´ì£¼ë“¯ ì¹œê·¼í•œ ë§íˆ¬ì˜ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    *   **ê°œë³„ ì¢…ëª© ë¦¬í¬íŠ¸ (`/reporting/stock/{code}`)**: íŠ¹ì • ì¢…ëª©ì˜ ê¸°ìˆ ì  ì§€í‘œì™€ ìµœì‹  ë‰´ìŠ¤ë¥¼ ì¢…í•©í•˜ì—¬ ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    *   **í˜ë¥´ì†Œë‚˜ ì „í™˜**: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ì„ í†µí•´ 'ì¹œí•œ ì¹œêµ¬' ëª¨ë“œì™€ 'ì „ë¬¸ê°€' ëª¨ë“œë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

*   **íš¨ìœ¨ì ì¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜**:
    *   **LLM í´ë¼ì´ì–¸íŠ¸ ì¶”ìƒí™”**: OpenAI, Google Gemini ë“± ë‹¤ì–‘í•œ LLM ì„œë¹„ìŠ¤ë¥¼ ì‰½ê²Œ êµì²´í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
    *   **Redis ìºì‹±**: LLM API ì‘ë‹µê³¼ ê°™ì´ ë¹„ìš©ì´ ë†’ê³  ë°˜ë³µì ì¸ ìš”ì²­ ê²°ê³¼ë¥¼ ìºì‹±í•˜ì—¬ API ë¹„ìš©ì„ ì ˆê°í•˜ê³  ì‘ë‹µ ì†ë„ë¥¼ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
    *   **DB ì—°ë™**: PostgreSQLì„ ì‚¬ìš©í•˜ì—¬ ê³¼ê±° ì¶”ì²œ ì´ë ¥ì„ ì €ì¥í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    *   **ë¹„ë™ê¸° ì²˜ë¦¬**: FastAPIì™€ `asyncio`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í†µí•´ ë†’ì€ ì„±ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ê¸°ìˆ  ìŠ¤íƒ

*   **API í”„ë ˆì„ì›Œí¬**: FastAPI
*   **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL
*   **ìºì‹œ**: Redis
*   **AI / ML**:
    *   **Sentiment Analysis**: `snunlp/KR-FinBert-SC`
    *   **LLM**: OpenAI (`gpt-4-turbo`), Google Gemini ë“±
*   **ë°ì´í„° ì†ŒìŠ¤**:
    *   **Market Data**: ê³µê³µë°ì´í„°í¬í„¸ (ì¦ê¶Œì •ë³´ì„œë¹„ìŠ¤)
    *   **News**: Naver Search API
*   **ì»¨í…Œì´ë„ˆ**: Docker, Docker Compose

## âš™ï¸ ì‹œì‘í•˜ê¸°

### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”.

```.env
# --- System ---
LOG_LEVEL=INFO
MARKET=KS # KS (ì½”ìŠ¤í”¼), KQ (ì½”ìŠ¤ë‹¥)
TZ=Asia/Seoul

# --- Database & Cache ---
DATABASE_URL=postgresql://user:password@db:5432/friendantial
REDIS_URL=redis://redis:6379/0

# --- LLM Provider ---
LLM_PROVIDER=openai # openai ë˜ëŠ” gemini
LLM_MODEL_NAME=gpt-4-turbo
LLM_PERSONA=friend # friend ë˜ëŠ” analyst
OPENAI_API_KEY=sk-...
GEMINI_API_KEY=...

# --- External APIs ---
# ê³µê³µë°ì´í„°í¬í„¸ API í‚¤ (URL-encoded)
DATA_GO_KR_API_KEY=...
# Naver API Credentials
NAVER_CLIENT_ID=...
NAVER_CLIENT_SECRET=...

# --- Postgres (for docker-compose) ---
POSTGRES_DB=friendantial
POSTGRES_USER=user
POSTGRES_PASSWORD=password
```

#### 5. ì„œë²„ ì‹¤í–‰
### 2. ì‹¤í–‰
í”„ë¡œì íŠ¸ëŠ” Docker Composeë¥¼ í†µí•´ ëª¨ë“  ì„œë¹„ìŠ¤(API, DB, Redis)ë¥¼ í•œ ë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
```bash
# Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.
docker-compose up --build -d
```
### 3. ì¢…ë£Œ

```bash 
# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆë¥¼ ì¤‘ì§€í•˜ê³  ì‚­ì œí•©ë‹ˆë‹¤. 
docker-compose down
```

## ğŸ“– ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

| ë©”ì„œë“œ | ê²½ë¡œ | ì„¤ëª… | ì£¼ìš” íŒŒë¼ë¯¸í„° | 
| :--- | :--- | :--- | :--- | 
| GET | /recommendations | ì¢…í•© ì ìˆ˜ ê¸°ë°˜ì˜ ì£¼ì‹ ì¶”ì²œ ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. | strategy: day_trader, long_term | 
| GET | /reporting/summary | ì¶”ì²œ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ LLMì´ ìƒì„±í•œ ìš”ì•½ ë¦¬í¬íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. | | 
| GET | /reporting/stock/{stock_code} | íŠ¹ì • ì¢…ëª©ì— ëŒ€í•œ LLM ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. | | 
| GET | /history/recommendations | ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ê³¼ê±° ì¶”ì²œ ì´ë ¥ì„ ì¡°íšŒí•©ë‹ˆë‹¤. | start_date, end_date | 
| GET | /health | ì„œë²„ì˜ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤. | |

> ê° ì—”ë“œí¬ì¸íŠ¸ì˜ ìƒì„¸í•œ íŒŒë¼ë¯¸í„°ì™€ ì‘ë‹µ í˜•ì‹ì€ ì„œë²„ ì‹¤í–‰ í›„ `http://127.0.0.1:8000/docs`ì—ì„œ í™•ì¸í•˜ì„¸ìš”.

## ğŸ’¡ API ì‚¬ìš© ì˜ˆì‹œ (cURL)
### ë‹¨ê¸° íŠ¸ë ˆì´ë” ì „ëµìœ¼ë¡œ ì¶”ì²œë°›ê¸°
```bash 
curl -X GET "http://127.0.0.1:8000/recommendations?strategy=day_trader"
```
### ì¶”ì²œ ê²°ê³¼ì— ëŒ€í•œ LLM ìš”ì•½ ë¦¬í¬íŠ¸ ë°›ê¸°
```bash 
curl -X GET "http://127.0.0.1:8000/reporting/summary"
```
### íŠ¹ì • ì¢…ëª©ì— ëŒ€í•œ LLM ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ ë°›ê¸° (ì˜ˆ: ì‚¼ì„±ì „ì)
```bash
curl -X GET "http://127.0.0.1:8000/reporting/stock/005930.KS"
```
### íŠ¹ì • ì¢…ëª©ì˜ ë‰´ìŠ¤ ê°ì„± ë¶„ì„í•˜ê¸° (ì˜ˆ: SKí•˜ì´ë‹‰ìŠ¤)
```bash
curl -X GET "http://127.0.0.1:8000/analysis/news-sentiment/SKí•˜ì´ë‹‰ìŠ¤"
```
### íŠ¹ì • ì¢…ëª©ì˜ ì‹œì„¸ ë°ì´í„° ì¡°íšŒí•˜ê¸° (ì˜ˆ: 005930.KS, ìµœê·¼ 30ì¼)
```bash
curl -X GET "http://127.0.0.1:8000/market-data/ohlcv/005930.KS?lookback_days=30"
```